!=================
! Description
!   A profile taken from GFDL CM4 AMIP run that the mass flux program produces extremely large heating.
!  
! Yi-Hsuan Chen
! 08/07/2020
!=================

!-----------------
!-----------------
!     note
!-----------------
!-----------------

! 1. There are 33 full levels and 34 half levels in CM4, xanadu release.
! 2. Surface height (pressure) is the height (pressure) at the lowest half level.
!    Wind speed at the surface should be zero.
! 3. Note that the vertical temperature gradient is very large at the lowest two levles (~ 290 K/km),
!    which, I believe, caused the MF program produces extremely large heating.

!----------------------
!----------------------
!     Input profiles
!----------------------
!----------------------

! pressure at half level (Pa)
  data p_half/     100.000  ,   400.000  ,   818.602  ,  1378.887  ,  2091.795  ,  2983.641  ,  4121.790  ,  5579.221  ,  7360.241  ,  9474.686  , 11994.277  , 14981.182  , 18494.854  , 22585.258  , 27294.766  , 32630.810  , 38505.950  , 44669.362  , 50759.044  , 56467.156  , 61635.976  , 66220.929  , 70229.747  , 73692.171  , 76652.866  , 79164.757  , 81281.966  , 83049.791  , 84513.360  , 85708.414  , 86664.377  , 87409.461  , 87953.514  , 88313.848  /

! height at half level (m)
  data z_half/   42099.086  , 33837.576  , 29608.878  , 26560.705  , 24159.830  , 22128.511  , 20267.898  , 18504.841  , 16861.473  , 15340.514  , 13897.776  , 12521.269  , 11201.830  ,  9946.613  ,  8749.528  ,  7615.302  ,  6555.573  ,  5591.362  ,  4745.612  ,  4024.647  ,  3420.867  ,  2918.279  ,  2501.131  ,  2156.000  ,  1871.093  ,  1636.405  ,  1443.425  ,  1286.556  ,  1160.209  ,  1059.185  ,   979.345  ,   917.786  ,   873.261  , 845.221  /

! pressure at full level (Pa)
  data p_full/     216.404  ,   584.531  ,  1074.508  ,  1710.654  ,  2511.381  ,  3522.120  ,  4813.790  ,  6428.665  ,  8373.014  , 10685.016  , 13432.426  , 16676.370  , 20471.994  , 24865.726  , 29883.429  , 35487.362  , 41511.424  , 47649.364  , 53562.417  , 59013.844  , 63901.040  , 68205.704  , 71947.074  , 75162.800  , 77902.062  , 80218.705  , 82162.709  , 83779.445  , 85109.489  , 86185.512  , 87036.387  , 87681.206  , 88133.558  /

! height at full level (m)
  data z_full/   37968.331  , 31723.227  , 28084.791  , 25360.268  , 23144.171  , 21198.205  , 19386.369  , 17683.157  , 16100.993  , 14619.145  , 13209.523  , 11861.550  , 10574.222  ,  9348.070  ,  8182.415  ,  7085.438  ,  6073.468  ,  5168.487  ,  4385.129  ,  3722.757  ,  3169.573  ,  2709.705  ,  2328.566  ,  2013.547  ,  1753.749  ,  1539.915  ,  1364.991  ,  1223.382  ,  1109.697  ,  1019.265  ,   948.565  ,   895.523  ,   859.241  /

! zonal wind velocity at full levels (m/s)
  data uu/      22.522  ,    16.119  ,    13.937  ,    12.410  ,    10.556  ,    10.327  ,     9.891  ,     8.381  ,     7.165  ,     5.648  ,     4.432  ,     3.342  ,     2.119  ,     0.697  ,    -0.804  ,    -2.102  ,    -3.096  ,    -3.659  ,    -3.724  ,    -3.870  ,    -3.509  ,    -3.423  ,    -2.777  ,    -2.755  ,    -3.329  ,    -3.097  ,    -3.778  ,    -4.311  ,    -4.667  ,    -6.113  ,    -6.840  ,    -7.036  ,    -6.609  /

! meridional wind velocity at full levels (m/s)
  data vv/     -15.618  ,    -6.786  ,    -2.674  ,    -0.094  ,     0.648  ,     0.592  ,     0.506  ,     0.027  ,    -0.950  ,    -1.145  ,    -1.180  ,    -1.201  ,    -1.449  ,    -1.932  ,    -1.993  ,    -1.653  ,    -1.692  ,    -1.823  ,    -1.763  ,    -0.891  ,     0.509  ,     0.932  ,     1.449  ,     1.154  ,     0.953  ,     0.306  ,    -0.194  ,    -1.554  ,    -1.912  ,    -2.539  ,    -3.220  ,    -2.626  ,    -0.906  /

! temperatur at full levels (K). Note that the vertical gradient is very large at the lowest two levles (~ 290 K/km)
  data tt/     203.464  ,   201.602  ,   199.583  ,   196.689  ,   195.292  ,   196.582  ,   198.815  ,   202.521  ,   205.630  ,   208.889  ,   211.346  ,   213.802  ,   214.484  ,   215.791  ,   216.866  ,   218.540  ,   221.716  ,   225.932  ,   230.965  ,   235.340  ,   239.128  ,   242.288  ,   244.821  ,   246.910  ,   248.463  ,   249.602  ,   248.885  ,   246.897  ,   245.606  ,   245.714  ,   245.470  ,   244.956  ,   234.138  /

! specific humidity at full levels (kg/kg)
       data qq/    0.1755E-05  ,  0.1745E-05  ,  0.1744E-05  ,  0.1745E-05  ,  0.1748E-05  ,  0.1745E-05  ,  0.1743E-05  ,  0.1760E-05  ,  0.1819E-05  ,  0.1971E-05  ,  0.2128E-05  ,  0.3019E-05  ,  0.4207E-05  ,  0.6811E-05  ,  0.1043E-04  ,  0.1540E-04  ,  0.2231E-04  ,  0.4271E-04  ,  0.6966E-04  ,  0.1081E-03  ,  0.1469E-03  ,  0.1712E-03  ,  0.1945E-03  ,  0.2210E-03  ,  0.2289E-03  ,  0.2230E-03  ,  0.2184E-03  ,  0.2152E-03  ,  0.2324E-03  ,  0.2488E-03  ,  0.2678E-03  ,  0.2467E-03  ,  0.9350E-04  /


! surface pressure (Pa)
  data psfc /88313.848/

! surface height (m)
  data zsfc /845.221/

! surface wint (m/s)
  data usfc /0./

! PBL depth (m)
  data z_pbl/     14.15/

! surface heat flux (K m/s)
  data w1_thv1_surf  / 9.74E-02/

! surface moisture flux (kg/kg m/s)
  data w1_qt1_surf   / 1.37E-06/


!---------------------------------------
!---------------------------------------
!   Output from the mass flux program
!---------------------------------------
!---------------------------------------

 ! sum of updraft mass flux (kg/ms/) at half level
 sum_up_massflux,  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.2145500      0.0000000E+00

 ! heat flux w'theta_li' (K m/s) at half level
 w1_thli1  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00 -0.9143704      0.0000000E+00

 ! temperature tendency from MF (K/day) at full level
 tdt_mf,  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00  0.0000000E+00
  0.0000000E+00  0.0000000E+00  -1753.084       2650.798    


