 
 ;======================
 ;======================
 ;  option_updraft_level, half                
 ;  option_env_half=centered-diff       
 ;======================
 ;======================
 
 !@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 ! is,ie,js,je           1           1           1           1
 ! i,j,           1           1
 ! is_mass_flux   1.000000    
 ! is_moist_updraft F F F F F F F F F F
 !@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 
 
 
 !=================
 ! Description
 ! A profile taken from GFDL CM4 AMIP run that the mass flux program has trouble
 !
 ! Yi-Hsuan Chen
 !=================
 
 !===================
 !===================
 !  Input profiles
 !===================
 !===================
 
 ! pressure at half level (Pa)
             data p_half/     100.000  ,   400.000  ,   818.602  ,  1378.887  ,  2091.795  ,  2983.641  ,  4121.790  ,  5579.221  ,  7360.241  ,  9474.686  , 11994.277  , 14981.182  , 18494.854  , 22585.258  , 27294.766  , 32630.811  , 38505.949  , 44669.363  , 50759.043  , 56467.156  , 61635.977  , 66220.930  , 70229.750  , 73692.172  , 76652.867  , 79164.758  , 81281.969  , 83049.789  , 84513.359  , 85708.414  , 86664.375  , 87409.461  , 87953.516  , 88313.852  ,
 
 ! height at half level above the surface (m)
             data z_half/   41253.863  , 32992.352  , 28763.658  , 25715.484  , 23314.609  , 21283.291  , 19422.678  , 17659.621  , 16016.252  , 14495.293  , 13052.556  , 11676.048  , 10356.609  ,  9101.393  ,  7904.307  ,  6770.081  ,  5710.352  ,  4746.141  ,  3900.391  ,  3179.426  ,  2575.646  ,  2073.058  ,  1655.910  ,  1310.779  ,  1025.872  ,   791.184  ,   598.204  ,   441.335  ,   314.988  ,   213.964  ,   134.124  ,    72.565  ,    28.040  ,     0.000  ,
 
 ! pressure at full level (Pa)
             data p_full/     216.404  ,   584.531  ,  1074.508  ,  1710.654  ,  2511.381  ,  3522.120  ,  4813.790  ,  6428.665  ,  8373.014  , 10685.016  , 13432.426  , 16676.369  , 20471.994  , 24865.727  , 29883.430  , 35487.363  , 41511.426  , 47649.363  , 53562.418  , 59013.844  , 63901.039  , 68205.703  , 71947.070  , 75162.797  , 77902.062  , 80218.703  , 82162.711  , 83779.445  , 85109.492  , 86185.516  , 87036.391  , 87681.203  , 88133.555  ,
 
 ! height at full level above the surface (m)
             data z_full/   37123.109  , 30878.006  , 27239.570  , 24515.047  , 22298.951  , 20352.984  , 18541.148  , 16837.936  , 15255.772  , 13773.924  , 12364.303  , 11016.329  ,  9729.001  ,  8502.850  ,  7337.194  ,  6240.217  ,  5228.247  ,  4323.266  ,  3539.908  ,  2877.536  ,  2324.352  ,  1864.484  ,  1483.345  ,  1168.326  ,   908.528  ,   694.694  ,   519.770  ,   378.161  ,   264.476  ,   174.044  ,   103.344  ,    50.302  ,    14.020  ,
 
 ! actual height at half level (m)
      data z_half_actual/   42099.086  , 33837.574  , 29608.879  , 26560.705  , 24159.830  , 22128.512  , 20267.898  , 18504.842  , 16861.473  , 15340.514  , 13897.776  , 12521.269  , 11201.830  ,  9946.613  ,  8749.528  ,  7615.302  ,  6555.573  ,  5591.362  ,  4745.612  ,  4024.647  ,  3420.867  ,  2918.279  ,  2501.131  ,  2156.000  ,  1871.093  ,  1636.405  ,  1443.425  ,  1286.556  ,  1160.209  ,  1059.185  ,   979.345  ,   917.786  ,   873.261  ,   845.221  ,
 
 ! actual height at full level (m)
      data z_full_actual/   37968.332  , 31723.227  , 28084.791  , 25360.268  , 23144.172  , 21198.205  , 19386.369  , 17683.156  , 16100.993  , 14619.145  , 13209.523  , 11861.550  , 10574.222  ,  9348.070  ,  8182.415  ,  7085.438  ,  6073.468  ,  5168.487  ,  4385.129  ,  3722.757  ,  3169.573  ,  2709.705  ,  2328.566  ,  2013.547  ,  1753.749  ,  1539.915  ,  1364.991  ,  1223.382  ,  1109.697  ,  1019.265  ,   948.565  ,   895.523  ,   859.241  ,
 
 ! zonal wind velocity at full levels (m/s)
                 data uu/      22.522  ,    16.119  ,    13.937  ,    12.410  ,    10.556  ,    10.327  ,     9.891  ,     8.381  ,     7.165  ,     5.648  ,     4.432  ,     3.342  ,     2.119  ,     0.697  ,    -0.804  ,    -2.102  ,    -3.096  ,    -3.659  ,    -3.724  ,    -3.870  ,    -3.509  ,    -3.423  ,    -2.777  ,    -2.755  ,    -3.329  ,    -3.097  ,    -3.778  ,    -4.311  ,    -4.667  ,    -6.113  ,    -6.840  ,    -7.036  ,    -6.609  ,
 
 ! meridional wind velocity at full levels (m/s)
                 data vv/     -15.618  ,    -6.786  ,    -2.674  ,    -0.094  ,     0.648  ,     0.592  ,     0.506  ,     0.027  ,    -0.950  ,    -1.145  ,    -1.180  ,    -1.201  ,    -1.449  ,    -1.932  ,    -1.993  ,    -1.653  ,    -1.692  ,    -1.823  ,    -1.763  ,    -0.891  ,     0.509  ,     0.932  ,     1.449  ,     1.154  ,     0.953  ,     0.306  ,    -0.194  ,    -1.554  ,    -1.912  ,    -2.539  ,    -3.220  ,    -2.626  ,    -0.906  ,
 
 ! temperatur at full levels (K)
                 data tt/     203.464  ,   201.602  ,   199.583  ,   196.689  ,   195.292  ,   196.582  ,   198.815  ,   202.521  ,   205.630  ,   208.889  ,   211.346  ,   213.802  ,   214.484  ,   215.791  ,   216.866  ,   218.540  ,   221.716  ,   225.932  ,   230.965  ,   235.340  ,   239.128  ,   242.288  ,   244.821  ,   246.910  ,   248.463  ,   249.602  ,   248.885  ,   246.897  ,   245.606  ,   245.714  ,   245.470  ,   244.956  ,   234.138  ,
 
 ! specific humidity at full levels (kg/kg)
                 data qq/    0.1755E-05  ,  0.1745E-05  ,  0.1744E-05  ,  0.1745E-05  ,  0.1748E-05  ,  0.1745E-05  ,  0.1743E-05  ,  0.1760E-05  ,  0.1819E-05  ,  0.1971E-05  ,  0.2128E-05  ,  0.3019E-05  ,  0.4207E-05  ,  0.6811E-05  ,  0.1043E-04  ,  0.1540E-04  ,  0.2231E-04  ,  0.4271E-04  ,  0.6966E-04  ,  0.1081E-03  ,  0.1469E-03  ,  0.1712E-03  ,  0.1945E-03  ,  0.2210E-03  ,  0.2289E-03  ,  0.2230E-03  ,  0.2184E-03  ,  0.2152E-03  ,  0.2324E-03  ,  0.2488E-03  ,  0.2678E-03  ,  0.2467E-03  ,  0.9350E-04  ,
 
 ! potential temperatur at full levels (K)
                 data th/    1174.466  ,   876.092  ,   728.845  ,   628.914  ,   559.567  ,   511.379  ,   473.022  ,   443.616  ,   417.671  ,   395.739  ,   375.053  ,   356.672  ,   337.448  ,   321.158  ,   306.245  ,   293.820  ,   285.031  ,   279.230  ,   276.067  ,   273.613  ,   271.769  ,   270.279  ,   268.969  ,   267.896  ,   266.838  ,   265.826  ,   263.255  ,   259.703  ,   257.185  ,   256.376  ,   255.403  ,   254.332  ,   242.743  ,
 
 ! PBL depth (m)
              data z_pbl/     14.15,
 
 ! buoyancy flux (m2/s3)
          data buoy_flux/    0.3934E-02,
 
 ! surface heat flux (K m/s)
       data w1_thv1_surf/    0.9744E-01,
 
 ! surface moisture flux (kg/kg m/s
        data w1_qt1_surf/    0.1372E-05,
 
             data u_star/      0.33,
             data b_star/    0.1192E-01,
             data q_star/    0.4157E-05,
 
 !=======================================
 !=======================================
 !  Output from the mass flux program
 !=======================================
 !=======================================
 
 ! sum of updraft mass flux (kg/m2/s) at half level
   data sum_up_massflux /       0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.215  ,     0.131  ,
 
 ! averaged updraft velocity (m/s) at half levels
          data avg_up_w /       0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     1.066  ,     0.635  ,
 
 ! heat flux w1_theta_li1 (K m/s) at half level
          data w1_thli1 /       0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,    -0.914  ,     0.000  ,
 
 ! temperature tendency from MF (K/day) at full level
            data tdt_mf /       0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  ,     0.000  , -1753.084  ,  2650.798  ,
 
 !-----------------------------
 !  Some vi commands
 !-----------------------------
 
 !*** Fortran
 ! remove the space at the beginning       : [1,$s/^ */  /g]
 ! replace ",$" to "/" at the end          : [1,$s/,$/\//g]
 
 !*** NCL 
 ! remove the space at the beginning       : [1,$s/^ */  /g]
 ! remove data                             : [1,$s/data //g]
 ! replace "/" to "=(/"                    : [1,$s/\/  / = (\//g]
 ! replace "," to "/" at the end           : [1,$s/,$/\/)/g]
 ! replace "!" to ";"                      : [1,$s/!/;/g]
 
